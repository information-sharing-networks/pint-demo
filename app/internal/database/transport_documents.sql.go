// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: transport_documents.sql

package database

import (
	"context"
	"encoding/json"
)

const CreateTransportDocumentIfNew = `-- name: CreateTransportDocumentIfNew :one
INSERT INTO transport_documents (
    checksum,
    created_at,
    content
) VALUES (
    $1,
    NOW(),
    $2
)
ON CONFLICT (checksum) DO NOTHING
RETURNING checksum, created_at, content
`

type CreateTransportDocumentIfNewParams struct {
	Checksum string          `json:"checksum"`
	Content  json.RawMessage `json:"content"`
}

// Insert transport document if it doesn't exist, otherwise return existing
// This is used when receiving a new envelope transfer
func (q *Queries) CreateTransportDocumentIfNew(ctx context.Context, arg CreateTransportDocumentIfNewParams) (TransportDocument, error) {
	row := q.db.QueryRow(ctx, CreateTransportDocumentIfNew, arg.Checksum, arg.Content)
	var i TransportDocument
	err := row.Scan(&i.Checksum, &i.CreatedAt, &i.Content)
	return i, err
}

const GetTransportDocument = `-- name: GetTransportDocument :one
SELECT checksum, created_at, content FROM transport_documents
WHERE checksum = $1
`

// Get transport document by checksum
func (q *Queries) GetTransportDocument(ctx context.Context, checksum string) (TransportDocument, error) {
	row := q.db.QueryRow(ctx, GetTransportDocument, checksum)
	var i TransportDocument
	err := row.Scan(&i.Checksum, &i.CreatedAt, &i.Content)
	return i, err
}
